import random
from typing import Any

import time

from vkbottle.bot import Message
from vkbottle.modules import json

from keyboards.menu import MENU_KEYBOARD, WRITER_KEYBOARD, ADMIN_MENU_KEYBOARD
from logger import logger
from utils.args_object import SCB
from vkbottle_overrides.bot import Blueprint
from rules.IsWriter import IsWriter
from constants.states import NotifyStates
from keyboards.misc import YN_KEYBOARD, BACK_TO_MENU
from keyboards.notifications import NOTIFY_TYPES_KEYBOARD
from vkbottle_overrides.dispatch.rules.bot import PayloadRule

bp = Blueprint()
bp.name = "Notifications"
bp.labeler.auto_rules.append(IsWriter())
#  phrases.load(Menu)


@bp.on.private_message(payload={"cmd": "notify"})
@bp.on.private_message(text="–û–ø–æ–≤–µ—Å—Ç–∏—Ç—å")
async def ask_for_text(message: Message, scb: SCB):
    await message.answer("–í—ã–±–µ—Ä–∏ —Ç–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è.", keyboard=NOTIFY_TYPES_KEYBOARD)
    await bp.state_dispenser.set(message.peer_id, NotifyStates.GET_USERS)


@bp.on.private_message(state=NotifyStates.GET_USERS)
async def ask_for_text(message: Message, scb: SCB):
    payload = json.loads(message.payload)
    key = list(payload.keys())[0]
    value = list(payload.values())[0]

    if key == 'is_writer':
        users = await scb.many_users.get_writers()
    else:
        users = await scb.many_users.get_many(key, value)
    scb.storage["users"] = users
    await message.answer(message="–¢–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç –æ–ø–æ–≤–µ—â–µ–Ω–∏—è.", keyboard=BACK_TO_MENU)
    await bp.state_dispenser.set(message.peer_id, NotifyStates.GET_TEXT)


@bp.on.private_message(state=NotifyStates.GET_TEXT)
async def confirm(message: Message, scb: SCB):
    scb.storage["notify_text"] = message.text
    users = scb.storage["users"]

    await message.answer(
        "–¢–µ–∫—Å—Ç –æ–ø–æ–≤–µ—â–µ–Ω–∏—è: %s. \n\n–Æ–∑–µ—Ä—ã: \n%s\n\n–†–∞—Å—Å—ã–ª–∞—é?" % (
            message.text,
            '\n'.join(f'{index + 1}. [id{i.uid}|{i.last_name} {i.first_name}]' for index, i in enumerate(users))
        ),
        keyboard=YN_KEYBOARD)
    await bp.state_dispenser.set(message.peer_id, NotifyStates.CONFIRM)


@bp.on.private_message(payload={"action": True}, state=NotifyStates.CONFIRM)
async def send(message: Message, scb: SCB):
    users = scb.storage["users"]
    sent = await message.answer("–†–∞—Å—Å—ã–ª–∞—é...", keyboard=BACK_TO_MENU)
    scb.storage["animated_message_text"] = "–†–∞—Å—Å—ã–ª–∞—é..."
    logger.debug("New attachment")

    await notify(users, scb.user, sent, scb.storage["notify_text"], scb)

    await bp.state_dispenser.delete(message.peer_id)


async def notify(users, writer, message_id, notify_text, scb):
    for i in users:
        if i.uid == writer.uid:
            continue
        try:
            await bp.api.messages.send(
                peer_id=i.uid,
                message=f"üîî | –û–ø–æ–≤–µ—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–∏–ª [id{writer.uid}|{writer.full_name}]: \n\n {notify_text}",
                random_id=random.randint(-2e10, 2e10)
            )
            scb.storage["animated_message_text"] = scb.storage[
                                                       "animated_message_text"] + f"\n‚úî | [id{i.uid}|{i.last_name} {i.first_name}]"
            time.sleep(0.3)
        except:
            scb.storage["animated_message_text"] = scb.storage["animated_message_text"] + f"\n‚ùå | [id{i.uid}|{i.last_name} {i.first_name}]"

        await bp.api.messages.edit(
            peer_id=writer.uid,
            message=scb.storage["animated_message_text"],
            message_id=message_id
        )


@bp.on.private_message(payload={"action": False}, state=NotifyStates.CONFIRM)
async def deny(message: Message, scb: SCB):
    await message.answer("–¥–∞ –∫–∞–∫–æ–≥–æ —Ö—É—è? \n–ë–ª—è–¥—å, –¥–∞ –º–Ω–µ –ø–æ—Ö—É–π –Ω–∞ —Ç–µ–±—è, –±–ª—è–¥—å, —Å–ª—É—à–∞–π. –ö–∞–∫–∞—è —É —Ç–µ–±—è —Ç–∞–º —Ç–∞—á–∫–∞, –±–ª—è–¥—å, –∫–≤–∞—Ä—Ç–∏—Ä—ã, —Å—Ä–∞—á–∫–∏, —Ç–∞–º –±–ª—è–¥—å, —è—Ö—Ç—ã, –≤—Å—ë ‚Äî –º–Ω–µ –ø–æ—Ö—É–π —Ç–∞–º. –•–æ—Ç—å ¬´–ë–µ–Ω—Ç–ª–∏¬ª, —Ö–æ—Ç—å, –±–ª—è–¥—å, –Ω–∞—Ö—É–π, ¬´–ú–∞–π–±–∞—Ö¬ª, —Ö–æ—Ç—å ¬´–†–æ–ª–ª—Å-–†–æ–π—Å¬ª, —Ö–æ—Ç—å ¬´–ë—É–≥–∞—Ç—Ç–∏¬ª, –±–ª—è–¥—å, —Ö–æ—Ç—å —Å—Ç–æ–º–µ—Ç—Ä–æ–≤–∞—è —è—Ö—Ç–∞ ‚Äî –º–Ω–µ –Ω–∞ —ç—Ç–æ –Ω–∞—Å—Ä–∞—Ç—å, –ø–æ–Ω–∏–º–∞–µ—à—å? –°–∫–æ–ª—å–∫–æ —Ç—ã —Ç–∞–º, –∫–æ–≥–æ –µ–±—ë—à—å, –∫–∞–∫–∏—Ö –±–∞–±, –∫–∞–∫–∏—Ö, –∑–Ω–∞—á–∏—Ç, –≤–æ—Ç —ç—Ç–∏—Ö —Å–∞–º–æ–∫, —à–∏–∫–∞—Ä–Ω—ã—Ö –∏–ª–∏ –∞—Ç–ª–∞—Å–Ω—ã—Ö, –±–ª—è–¥—å, –≤ –∫–æ—Å–º–æ—Å –ª–∏ —Ç—ã –ª–µ—Ç–∏—à—å ‚Äî –º–Ω–µ –Ω–∞ —ç—Ç–æ –Ω–∞—Å—Ä–∞—Ç—å, –ø–æ–Ω–∏–º–∞–µ—à—å? –Ø, –±–ª—è–¥—å, –≤ —Å–≤–æ–µ–º –ø–æ–∑–Ω–∞–Ω–∏–∏ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –ø—Ä–µ–∏—Å–ø–æ–ª–Ω–∏–ª—Å—è, —á—Ç–æ —è –∫–∞–∫ –±—É–¥—Ç–æ –±—ã —É–∂–µ —Å—Ç–æ —Ç—Ä–∏–ª–ª–∏–æ–Ω–æ–≤ –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –ª–µ—Ç, –±–ª—è–¥—å, –ø—Ä–æ–∂–∏–≤–∞—é –Ω–∞ —Ç—Ä–∏–ª–ª–∏–æ–Ω–∞—Ö –∏ —Ç—Ä–∏–ª–ª–∏–æ–Ω–∞—Ö —Ç–∞–∫–∏—Ö –∂–µ –ø–ª–∞–Ω–µ—Ç, –ø–æ–Ω–∏–º–∞–µ—à—å? –ö–∞–∫ —ç—Ç–∞ –ó–µ–º–ª—è. –ú–Ω–µ —É–∂–µ —ç—Ç–æ—Ç –º–∏—Ä –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø–æ–Ω—è—Ç–µ–Ω, –∏ —è –∑–¥–µ—Å—å –∏—â—É —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ, –±–ª—è–¥—å: –ø–æ–∫–æ—è, —É–º–∏—Ä–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –≤–æ—Ç —ç—Ç–æ–π –≥–∞—Ä–º–æ–Ω–∏–∏ –æ—Ç —Å–ª–∏—è–Ω–∏—è —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –≤–µ—á–Ω—ã–º, –æ—Ç —Å–æ–∑–µ—Ä—Ü–∞–Ω–∏—è —ç—Ç–æ–≥–æ –≤–µ–ª–∏–∫–æ–≥–æ —Ñ—Ä–∞–∫—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–æ–±–∏—è –∏ –æ—Ç –≤–æ—Ç —ç—Ç–æ–≥–æ –≤–æ—Ç –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –≤—Å–µ–µ–¥–∏–Ω—Å—Ç–≤–∞ —Å—É—â–µ—Å—Ç–≤–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –≤–µ—á–Ω–æ–≥–æ ‚Äî –∫—É–¥–∞ –Ω–∏ –ø–æ—Å–º–æ—Ç—Ä–∏: —Ö–æ—Ç—å –≤ –≥–ª—É–±—å ‚Äî –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –º–∞–ª–æ–µ, —Ö–æ—Ç—å –≤–≤—ã—Å—å ‚Äî –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –±–æ–ª—å—à–æ–µ, –ø–æ–Ω–∏–º–∞–µ—à—å? –ê —Ç—ã –º–Ω–µ –æ–ø—è—Ç—å —Å–æ —Å–≤–æ–∏–º–∏, —Ç–∞–º, —ç—Ç–æ. –ò–¥–∏, —Å—É–µ—Ç–∏—Å—å –¥–∞–ª—å—à–µ, —Ç–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ‚Äî —ç—Ç–æ —Ç–≤–æ–π –ø—É—Ç—å –∏ —Ç–≤–æ–π –≥–æ—Ä–∏–∑–æ–Ω—Ç –ø–æ–∑–Ω–∞–Ω–∏—è, –æ—â—É—â–µ–Ω–∏—è –∏ —Ç–≤–æ–µ–π –ø—Ä–∏—Ä–æ–¥—ã. –ò –æ–Ω –Ω–µ—Å–æ–∏–∑–º–µ—Ä–∏–º–æ –º–µ–ª–æ–∫ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–æ–∏–º, –ø–æ–Ω–∏–º–∞–µ—à—å? –Ø –∫–∞–∫ –±—É–¥—Ç–æ —É–∂–µ –≥–ª—É–±–æ–∫–∏–π —Å—Ç–∞—Ä–µ—Ü –±–µ—Å—Å–º–µ—Ä—Ç–Ω—ã–π –∏–ª–∏, —Ç–∞–º, —É–∂–µ –ø–æ—á—Ç–∏ –±–µ—Å—Å–º–µ—Ä—Ç–Ω—ã–π, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ —ç—Ç–æ–π –ø–ª–∞–Ω–µ—Ç–µ –æ—Ç –µ—ë —Å–∞–º–æ–≥–æ –∑–∞—Ä–æ–∂–¥–µ–Ω–∏—è, –µ—â–µ –∫–æ–≥–¥–∞ —Ç–æ–ª—å–∫–æ –°–æ–ª–Ω—Ü–µ —Ç–æ–ª—å–∫–æ-—Ç–æ–ª—å–∫–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–æ—Å—å –∫–∞–∫ –∑–≤–µ–∑–¥–∞ –∏ –≤–æ—Ç —ç—Ç–æ –≥–∞–∑–æ–ø—ã–ª–µ–≤–æ–µ –æ–±–ª–∞–∫–æ, –≤–æ—Ç, –ø–æ—Å–ª–µ –≤–∑—Ä—ã–≤–∞ –°–æ–ª–Ω—Ü–∞, –∫–æ–≥–¥–∞ –æ–Ω–æ –≤—Å–ø—ã—Ö–Ω—É–ª–æ, –∫–∞–∫ –∑–≤–µ–∑–¥–∞, –Ω–∞—á–∞–ª–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–æ–∞—Ü–µ—Ä–≤–∞—Ç—ã-–ø–ª–∞–Ω–µ—Ç—ã, –ø–æ–Ω–∏–º–∞–µ—à—å? –Ø –Ω–∞ —ç—Ç–æ–π –ó–µ–º–ª–µ —É–∂–µ –∫–∞–∫ –±—É–¥—Ç–æ –ø–æ—á—Ç–∏ –ø—è—Ç—å –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –ª–µ—Ç, –±–ª—è–¥—å, –∂–∏–≤—É –∏ –∑–Ω–∞—é –µ—ë —É–∂–µ –≤–¥–æ–ª—å –∏ –ø–æ–ø–µ—Ä–µ–∫, —ç—Ç–æ—Ç –≤–µ—Å—å –º–∏—Ä, –∞ —Ç—ã –º–Ω–µ, —Ç–∞–º, –∫–∞–∫–∏–µ-—Ç–æ —ç—Ç–æ. –ú–Ω–µ –ø–æ—Ö—É–π –Ω–∞ —Ç–≤–æ–∏ —Ç–∞—á–∫–∏, –Ω–∞ —Ç–≤–æ–∏, –±–ª—è–¥—å, –Ω–∞—Ö—É–π, —è—Ö—Ç—ã, –Ω–∞ —Ç–≤–æ–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã, —Ç–∞–º, –Ω–∞ —Ç–≤–æ—ë –±–ª–∞–≥–æ, –ø–æ–Ω–∏–º–∞–µ—à—å? –Ø –±—ã–ª –Ω–∞ —ç—Ç–æ–π –ø–ª–∞–Ω–µ—Ç–µ, —Ç–∞–∫ —Å–∫–∞–∑–∞—Ç—å, –∏–ª–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ, –∏ –∫—Ä—É—á–µ –¶–µ–∑–∞—Ä—è, –∏ –∫—Ä—É—á–µ –ì–∏—Ç–ª–µ—Ä–∞, –±–ª—è–¥—å, –∏ –∫—Ä—É—á–µ –≤—Å–µ—Ö –≤–µ–ª–∏–∫–∏—Ö, –ø–æ–Ω–∏–º–∞–µ—à—å, –±—ã–ª? –ê –≥–¥–µ-—Ç–æ –±—ã–ª –∫–æ–Ω—á–µ–Ω—ã–º –≥–æ–≤–Ω–æ–º, –µ—â—ë —Ö—É–∂–µ, —á–µ–º –∑–¥–µ—Å—å. –ü–æ—Ç–æ–º—É —á—Ç–æ —è –º–Ω–æ–∂–µ—Å—Ç–≤–æ —ç—Ç–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π —á—É–≤—Å—Ç–≤—É—é. –ì–¥–µ-—Ç–æ —è –±—ã–ª –±–æ–ª—å—à–µ –ø–æ–¥–æ–±–µ–Ω —Ä–∞—Å—Ç–µ–Ω–∏—é, –≥–¥–µ-—Ç–æ –±—ã–ª –±–æ–ª—å—à–µ –ø–æ–¥–æ–±–µ–Ω –ø—Ç–∏—Ü–µ, —Ç–∞–º, —á–µ—Ä–≤—é, –≥–¥–µ-—Ç–æ –ø—Ä–æ—Å—Ç–æ –±—ã–ª —Å–≥—É—Å—Ç–æ–∫ –∫–∞–º–Ω—è. –≠—Ç–æ –≤—Å–µ –µ—Å—Ç—å –¥—É—à–∞, –ø–æ–Ω–∏–º–∞–µ—à—å? –û–Ω–∞ –≤–æ—Ç –∏–º–µ–µ—Ç –≥—Ä–∞–Ω–∏ –ø–æ–¥–æ–±–∏—è —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –º–Ω–æ–≥–æ–æ–±—Ä–∞–∑–Ω—ã–µ, –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ. –ù–æ —Ç–µ–±–µ —ç—Ç–æ–≥–æ –Ω–µ –ø–æ–Ω—è—Ç—å, –ø–æ—ç—Ç–æ–º—É —Ç—ã –µ–∑–∂–∞–π —Å–µ–±–µ, –±–ª—è–¥—å. –ú—ã –≤ —ç—Ç–æ–º –º–∏—Ä–µ –∫–∞–∫ –±—ã –∂–∏–≤—ë–º —Ä–∞–∑–Ω—ã–º–∏ –æ—â—É—â–µ–Ω–∏—è–º–∏, —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–µ–º–ª–µ–Ω–∏—è–º–∏. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, —Ä–∞–∑–Ω–æ–µ –Ω–∞—à–µ –∏ –º–µ—Å—Ç–æ, —Ä–∞–∑–Ω–æ–µ –Ω–∞—à–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ. –¢–µ–±–µ —è –∂–µ–ª–∞—é, –≤—Å–µ —Å–∞–º—ã–µ –∫—Ä—É—Ç—ã–µ —Ç–∞—á–∫–∏ —á—Ç–æ–±—ã –±—ã–ª–∏ —É —Ç–µ–±—è, –∏ –≤—Å–µ —Å–∞–º—ã–µ –ª—É—á—à–∏–µ —Å–∞–º–∫–∏, —á—Ç–æ–±—ã —Ä–∞–∑–¥–≤–∏–≥–∞–ª–∏ –ø–µ—Ä–µ–¥ —Ç–æ–±–æ–π –Ω–æ–≥–∏ —Ç–∞–º, –≤—Å–µ —Å–≤–æ–∏ —â–µ–ª–∏ –Ω–∞—à–∏–≤–æ—Ä–æ—Ç-–Ω–∞–≤—ã–≤–æ—Ä–æ—Ç, –±–ª—è–¥—å, –ø–µ—Ä–µ–¥ —Ç–æ–±–æ–π, –∫–∞–∫ –∫–æ–≤—ë—Ä, —ç—Ç–æ —Å–∞–º–æ–µ, —Ä–∞—Å–∫—Ä—ã–≤–∞–ª–∏ –∏ —Ä–∞—Å—Ç–ª–µ–≤–∞–ª–∏, —Ä–∞—Å—Ç–ª–∞–ª–∏. –ò —Ç—ã –∏—Ö —á—Ç–æ–±—ã –µ–±–∞–ª, –¥–æ –ø–æ—Å–∏–Ω–µ–Ω–∏—è, –¥–æ –∫—Ä–∞—Å–Ω–∞, –¥–æ —Å–æ–ª–Ω—Ü–∞ –∑–∞–∫–∞—Ç–Ω–æ–≥–æ. –ß—Ç–æ–± –Ω–∞ –ª—É—á—à–∏—Ö —è—Ö—Ç–∞—Ö, –Ω–∞ —Å–∞–º–æ–ª—ë—Ç–∞—Ö –ª–µ—Ç–∞–ª –∏ –∫–æ–Ω—á–∞–ª –ø—Ä—è–º–æ —Å –∏–ª–ª—é–º–∏–Ω–∞—Ç–æ—Ä–∞ –∏ –≤—Å—ë, —á—Ç–æ —Ç–æ–ª—å–∫–æ –º–æ–∂–µ—Ç –≤ –≥–æ–ª–æ–≤—É –ø—Ä–∏–π—Ç–∏ –∏ –Ω–µ –ø—Ä–∏–π—Ç–∏. –ï—Å–ª–∏ –º–∞–ª–æ –∏–¥–µ–π ‚Äì –æ–±—Ä–∞—â–∞–π—Å—è –∫–æ –º–Ω–µ, —è —Ç–µ–±–µ –Ω–∞ –∫–∞–∂–¥—É—é —Ç–≤–æ—é –∏–¥–µ—é –µ—â–µ —Å–æ—Ç–Ω–∏ —Ç—Ä–∏–ª–ª–∏–æ–Ω–æ–≤ –ø–æ–¥—Å–∫–∞–∂—É –∫–∞–∫, —á—Ç–æ –¥–µ–ª–∞—Ç—å. –ù—É –∞ —è –≤—Å—ë, —è –∏–¥—É, –∫–∞–∫ –≥–ª—É–±–æ–∫–∏–π —Å—Ç–∞—Ä–µ—Ü, —É–∑—Ä–∏–≤—à–∏–π –≤–µ—á–Ω–æ–µ, –ø—Ä–∏–∫–æ—Å–Ω—É–≤—à–∏–π—Å—è –∫ –±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–º—É, —Å–∞–º —Å—Ç–∞–ª –±–æ–≥–æ–ø–æ–¥–æ–±–µ–Ω –∏ —É—Å—Ç—Ä–µ–º–ª–µ–Ω –≤ —ç—Ç–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ, –∫–æ—Ç–æ—Ä—ã–π –≤ —É–º–∏—Ä–æ—Ç–≤–æ—Ä–µ–Ω–∏–∏, –ø–æ–∫–æ–µ, –≥–∞—Ä–º–æ–Ω–∏–∏, –±–ª–∞–≥–æ–¥–∞—Ç–∏, –≤ —ç—Ç–æ–º —Å–æ–∫—Ä–æ–≤–µ–Ω–Ω–æ–º –±–ª–∞–∂–µ–Ω—Å—Ç–≤–µ –ø—Ä–µ–±—ã–≤–∞–µ—Ç, –≤–æ–≤–ª–µ—á—ë–Ω–Ω—ã–π –≤–æ –≤—Å—ë –∏ –≤–æ –≤—Å—è, –ø–æ–Ω–∏–º–∞–µ—à—å? –í–æ—Ç –∏ –≤—Å—ë. –í —ç—Ç–æ–º –Ω–∞—à–∞ —Ä–∞–∑–Ω–∏—Ü–∞. –¢–∞–∫ —á—Ç–æ, —è –∏–¥—É –ª—é–±–æ–≤–∞—Ç—å—Å—è –º–∏—Ä–æ–∑–¥–∞–Ω–∏–µ–º, –∞ —Ç—ã –∏–¥—ë—à—å –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–µ–∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –≥—Ä–∞–Ω—è—Ö –∫–∞–∫–∏—Ö-—Ç–æ. –í–æ—Ç –∏ –≤—Å—è —Ä–∞–∑–Ω–∏—Ü–∞, –ø–æ–Ω–∏–º–∞–µ—à—å? –¢—ã –Ω–µ –∑—Ä–∏—à—å —ç—Ç–æ –≤–µ—á–Ω–æ–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ, –æ–Ω–æ —Ç–µ–±–µ –Ω–µ –Ω—É–∂–Ω–æ. –ù–æ –∑–∞—Ç–æ —Ç—ã, —Ç–∞–∫ —Å–∫–∞–∑–∞—Ç—å, –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–µ–Ω, –∫–∞–∫ –≤–æ—Ç —ç—Ç–æ—Ç –¥—è—Ç–µ–ª –¥–æ–ª–±—è—â–∏–π –∏–ª–∏ –º—É—Ä–∞–≤–µ–π, –∫–æ—Ç–æ—Ä—ã–π –≤–æ—Ç –æ—á–µ–Ω—å –∞–∫—Ç–∏–≤–µ–Ω –≤ —Å–≤–æ–µ–π —Å—Ç–µ–∑–µ, –≤–æ—Ç –∏ –≤—Å—ë. –ü–æ—ç—Ç–æ–º—É –¥–∞–≤–∞–π, –Ω–∞—à–∏ –ø—É—Ç–∏ –∑–¥–µ—Å—å, —Ç–∞–∫ —Å–∫–∞–∑–∞—Ç—å, –∏–º–µ—é—Ç, –∫–æ–Ω–µ—á–Ω–æ, –≥—Ä–∞–Ω–∏ –ø–æ–¥–æ–±–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—Å—ë –µ–¥–∏–Ω–æ, –Ω–æ —Ç—ã –º–µ–Ω—è‚Ä¶ –Ø-—Ç–æ —Ç–µ–±—è –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –ø–æ–Ω–∏–º–∞—é, –∞ –≤–æ—Ç —Ç—ã ‚Äî –≤—Ä—è–¥ –ª–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ, –∫–∞–∫ –±—ã, —è, —Ç—ã –∏, –∫–∞–∫ –±—ã, —è —Ç–µ–±—è –≤ —Å–µ–±–µ —Å–æ–¥–µ—Ä–∂—É ‚Äî –≤—Å—é —Ç–≤–æ—é –ø—Ä–∏—Ä–æ–¥—É, –æ–Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–Ω—É –º–∞–ª–µ–Ω—å–∫—É—é, —Ç–∞–º, –ø–µ—Å—á–∏–Ω–æ—á–∫—É –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –µ—Å—Ç—å –≤–æ –º–Ω–µ, –ø–æ–Ω–∏–º–∞–µ—à—å? –í–æ—Ç –∏ –≤—Å—ë. –ü–æ—ç—Ç–æ–º—É –¥–∞–≤–∞–π —Å—Ç—É–ø–∞–π, –µ–∑–∂–∞–π, –∞ —è –ø–æ—à–µ–ª –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è, –Ω–∞—Ö—É–π, –±–ª—è–¥—å, –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–º –æ—Å–µ–Ω–Ω–∏–º –∑–∞–∫–∞—Ç–æ–º, –±–ª—è–¥—å, –Ω–∞ –±–µ—Ä–µ–≥—É —Ç—ë–ø–ª–æ–π —é–∂–Ω–æ–π —Ä–µ–∫–∏. –í—Å—ë, –ø–∏–∑–¥—É–π-–±–æ—Ä–æ–∑–¥—É–π –∏ —è –ø–æ–ø–∏–∑–¥–∏–ª –Ω–∞—Ö—É–π.", keyboard=BACK_TO_MENU)
    await bp.state_dispenser.delete(message.peer_id)
